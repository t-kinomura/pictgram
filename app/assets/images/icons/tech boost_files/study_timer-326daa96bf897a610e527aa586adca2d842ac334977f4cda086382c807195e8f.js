(function(){$(function(){var t,e,n,a,u,r,s,i,d,o,l,c,f,m,y,_,v;return f=0,y=0,r=!1,i=!1,e=!1,m=null,l=new Date,o=function(){y=setInterval(_,1e3),l=new Date,n()},c=function(){clearInterval(y),a()},a=function(){var t;(t=document.getElementById("btn-study-timer-icon")).classList.remove("fa-stop"),t.classList.add("fa-play"),document.getElementById("study-timer-text-message").innerHTML="\u5b66\u7fd2\u8a18\u9332"},n=function(){var t;(t=document.getElementById("btn-study-timer-icon")).classList.remove("fa-play"),t.classList.add("fa-stop"),document.getElementById("study-timer-text-message").innerHTML="\u8a18\u9332\u4e2d"},_=function(){return document.getElementById("study-timer-text-counter").innerHTML=s(++f)},s=function(e){var n,a,u;return e=Number(e),n=Math.floor(e/3600),a=Math.floor(e%3600/60),u=Math.floor(e%3600%60),t(n)+":"+t(a)+":"+t(u)},t=function(t){return t<10?"0"+t:t},d=function(t){return $.ajax({url:"/api/v1/students/study_times",type:"POST",data:{study_time:{time:f,started_at:l,count_flag:t}}})},v=function(t,e){return $.ajax({url:"/api/v1/students/study_times/"+e,type:"PUT",data:{study_time:{time:f,started_at:l,count_flag:t}}})},document.getElementById("btn-study-timer").onclick=function(){if(0!==f&&r)v(r=!1,m),c();else{if(null!==m)return v(r=!0,m),o(f);r=!0,i=!0,e=!0,o(f)}},u=function(){return $.ajax({url:"/api/v1/students/study_times",type:"GET",async:!1}).success(function(t){return null!==t.data&&!1===i?(r=t.data.count_flag,m=t.data.id,l=t.data.started_at):e?(i=!0,r=!0,m=null):(i=!0,m=null)}).error(function(){alert("error")})},function(){return $.ajax({url:"/api/v1/students/study_times",type:"GET",async:!1}).success(function(t){return null===t.data?(i=!0,m=null):(r=t.data.count_flag,m=t.data.id,l=t.data.started_at,f=t.data.time,i=!1,r?(v(r,m),o(f)):void 0)}).error(function(){alert("error")})}(),$(window).on("beforeunload",function(){u(e),i&&r?d(r):null!==m&&r&&v(r,m)})})}).call(this);